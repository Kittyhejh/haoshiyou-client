<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

    <!-- Start of Google Analytics -->
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                    m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-55311687-1', 'auto');
        ga('require', 'displayfeatures');
        ga('send', 'pageview');

    </script>
    <!-- End of Google Analytics -->

    <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="bootstrap/css/bootstrap-theme.min.css"/>
    <link rel="stylesheet" href="font-awesome-4.2.0/css/font-awesome.min.css"/>
    <link rel="stylesheet" href="style.css"/>
</head>
<body>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4 col-lg-4 col-lg-offset-4" >
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">湾区租房互助群</a>
        </div>
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-nav navbar-right">
                <!--<li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">类别 <span class="caret"></span></a>
                    <ul class="dropdown-menu" role="menu">
                        <li><a href="/view.html?filter=出租">出租</a></li>
                        <li><a href="/view.html?filter=求租">求租</a></li>
                        <li><a href="/view.html?filter=找室友">找室友</a></li>
                    </ul>
                </li>-->
                <li><a href="/group-qrcode.jpg">入群 <i class="fa fa-qrcode"></i></a></li>
                <li><a href="http://rent-form.zzn.im">填表 <i class="fa fa-plus"></i></a></li>
            </ul>
        </div><!--/.nav-collapse -->
        </div>
    </div><!--/.container-fluid -->
</div>

<div class="container">

    <div class="height-60px"></div>

    <div class="outwrapper">
    <div class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4 col-lg-4 col-lg-offset-4" id="value_panel_parent">
        <div class="panel" id="value_panel_template">
            <!-- Default panel contents -->
            <div class="panel-heading">
                <span><i class="fa fa-crosshairs"></i> </span>
                <span id="value_xq" class="zzn-content"></span>
                <span class="pull-right"><a id="row_link" href=""><i class="fa fa-link"></i></a></span>
            </div>
            <table class="table ">
                <tr>
                    <td><i class="fa fa-clock-o"></i> 发布时间</td>
                    <td id="value_fbsj" class="zzn-content"></td>
                </tr>
                <tr>
                    <td><i class="fa fa-clock-o"></i> 起始时间</td>
                    <td id="value_qssj" class="zzn-content"></td>
                </tr>
                <tr>
                    <td><i class="fa fa-location-arrow"></i> 位置</td>
                    <td id="value_wz" class="zzn-content"></td>
                </tr>
                <tr>
                    <td><i class="fa fa-calculator"></i> 预期价格</td>
                    <td id="value_yqjg" class="zzn-content"></td>
                </tr>
                <tr class="detail">
                    <td><i class="fa fa-child"></i> 性别</td>
                    <td id="value_xb" class="zzn-content"></td>
                </tr>
                <tr class="detail">
                    <td ><i class="fa fa-weixin"></i> 微信号</td>
                    <td class="zzn-content">
                        <span id="value_wxId"></span>
                        <button class="btn btn-success btn-xs" id="btn_show_wxId">显示 <i class="glyphicon glyphicon-eye-open"></i></button>
                    </td>
                </tr>
                <tr class="detail">
                    <td><i class="fa fa-mail-forward"></i> 电话邮箱</td>
                    <td class="zzn-content">
                        <span id="value_dhyx"></span>
                        <button class="btn btn-success btn-xs" id="btn_show_dhyx">显示 <i class="glyphicon glyphicon-eye-open"></i></button>
                    </td>
                </tr>
                <tr class="detail">
                    <td colspan="2"><i class="fa fa-user"></i> 个人介绍</td>
                </tr>
                <tr class="detail">
                    <td  colspan="2">
                        <p><span id="value_grjs"></span></p>
                    </td>
                </tr>
            </table>
            <div class="panel-footer">
                <span class="zzn-panel-footer-button" data-toggle="modal" data-target="#notReadyModal"><i class="fa fa-share-alt"></i></span>
                <span class="zzn-panel-footer-button" data-toggle="modal" data-target="#notReadyModal"><i class="fa fa-thumbs-up"></i></span>
                <span class="zzn-panel-footer-button" data-toggle="modal" data-target="#notReadyModal"><i class="fa fa-bookmark"></i></span>
                <button class="btn btn-primary btn-xs pull-right" id="btn_show_detail"><i class="fa fa-bookmark"></i> 详细信息</button>
            </div>
        </div>

    </div>

    </div>
    <div class="height-100px"></div>
    <div class="row">
        <a id="rent-result" class="link-btn col-xs-10 col-xs-offset-1 col-sm-8 col-sm-offset-2 col-md-4 col-md-offset-4 col-lg-4 col-lg-offset-4 btn btn-success"
           href="http://rent-result.zzn.im">
            查看总信息表
        </a>
    </div>
    <div class="height-30px"></div>

    <h3 class="group-qr-code-caption">入群请扫描QR-Code </h3>
    <div class="row">
        <div class="">
            <img class="col-xs-8 col-xs-offset-2 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4 col-lg-4 col-lg-offset-4" src="group-qrcode.jpg" alt=""/>
        </div>
    </div>
    <div class="height-100px"></div>

</div>


<nav class="navbar navbar-default navbar-fixed-bottom" role="navigation">
    <div class="container">
        <div class="col-xs-12 col-sm-6 col-sm-offset-3 col-md-4 col-md-offset-4 col-lg-4 col-lg-offset-4" >
            <div class="navbar-header">
                <ul class="nav navbar-nav">
                    <li><a href="https://www.linkedin.com/in/zainanvictorzhou/">Zainan Zhou <i class="fa fa-linkedin-square"></i></a></li>
                </ul>
            </div>
        </div>
    </div>
</nav>
<!-- Modal -->
<div class="modal fade" id="notReadyModal" tabindex="-1" role="dialog" aria-labelledby="notReadyModal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="myModalLabel"><i class="fa fa-paint-brush"></i> 敬请期待</h4>
            </div>
            <div class="modal-body">
                <p>搜索功能尚在开发中 ：）</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
            </div>
        </div>
    </div>
</div>

<script src="jquery-2.1.1.min.js"></script>
<script src="jquery.cookie.js"></script>
<script src="bootstrap/js/bootstrap.min.js"></script>
<script src="purl.js"></script>
<script src="//www.parsecdn.com/js/parse-1.3.0.min.js"></script>
<script src="guid.js"></script>
<script src="parsetrack.js"></script>
<!-- Start of Woopra Code -->
<script>
    (function () {
        var t, i, e, n = window, o = document, a = arguments, s = "script", r = ["config", "track", "identify", "visit", "push", "call", "trackForm", "trackClick"], c = function () {
            var t, i = this;
            for (i._e = [], t = 0; r.length > t; t++)(function (t) {
                i[t] = function () {
                    return i._e.push([t].concat(Array.prototype.slice.call(arguments, 0))), i
                }
            })(r[t])
        };
        for (n._w = n._w || {}, t = 0; a.length > t; t++)n._w[a[t]] = n[a[t]] = n[a[t]] || new c;
        i = o.createElement(s), i.async = 1, i.src = "//static.woopra.com/js/w.js", e = o.getElementsByTagName(s)[0], e.parentNode.insertBefore(i, e)
    })("woopra");

    woopra.config({
        domain: 'rent.zzn.im'
    });

    woopra.track();
</script>
<!-- End of Woopra Code -->

<script>
    jQuery(function ($) {
        $(document).ready(function () {
            var template = $("#value_panel_template").clone();
            var parent = $("#value_panel_parent").empty();
            // Init view
            parseTrack("view");

            var geoinfo = {};

            $.getJSON("http://www.telize.com/geoip?callback=?",
                    function (jsonp) {

                        geoinfo.ip = jsonp.ip;
                        geoinfo.city = jsonp.city;
                        geoinfo.country = jsonp.country;
                        geoinfo.gmapurl = "http://maps.google.com/?q=" + geoinfo.latitude + "," + geoinfo.longitude;

                        var strgeoinfo = JSON.stringify(strgeoinfo);
                        ga('send', 'event', 'button', 'click', 'view-geo',{ "strgeoinfo": strgeoinfo});
                        woopra.track('view-geo', { "strgeoinfo": strgeoinfo});
                        parseTrack("view-geo", {
                            strgeoinfo: strgeoinfo,
                            ip: geoinfo.ip,
                            city: geoinfo.city,
                            country: geoinfo.country
                        });

                    }
            );

            $.ajaxPrefilter(function(options) {
                if(options.crossDomain && jQuery.support.cors) {
                    var http = (window.location.protocol === 'http:' ? 'http:' : 'https:');
                    options.url = http + '//cors-anywhere.herokuapp.com/' + options.url;
                    //options.url = "http://cors.corsproxy.io/url=" + options.url;
                }
            });
            var url = "https://spreadsheets.google.com/feeds/list/1vzugrYLpgXmFODqysSx331Lhq8LpDQGJ4sQtwSMrtV4/1/public/values?alt=json";
            var columns = {
              xq: "gsx$需求类别",
              qssj: "gsx$预计起始日期超过这个日期本条信息失效",
              wz: "gsx$位置",
              yqjg: "gsx$预期价格美元每月",
              grjs: "gsx$租房需求介绍和自我介绍",
              wxId: "gsx$微信号",
              xb: "gsx$性别",
              dhyx: "gsx$其他联系方式电话邮箱等",
              fbsj: "gsx$timestamp"
            };
            var setLoad = function() {
                for (var col in columns) {
                    $("#value_" + col).text("");
                }
            };

            var row = 1;
            setLoad();
            $.get(url, function(data) {
                var pageRow = parseInt($.url().param("row"));
                var createChild = function(row) {
                    var child = template.clone();
                    var xq = data.feed.entry[row][columns["xq"]]["$t"];
                    child.find("#value_dhyx").hide();
                    child.find(".detail").hide();
                    var getCell = function(row, col) {
                        return data.feed.entry[row][columns[col]]["$t"] || "N/A";
                    };

                    for (var col in columns) {
                        child.find("#value_" + col).text(getCell(row, col));

                    }
                    if (xq == "出租") {
                        child.addClass("panel-success");
                    } else if (xq == "求租") {
                        child.addClass("panel-primary");
                    } else if (xq == "找室友") {
                        child.addClass("panel-warning");
                    }
                    child.find("#value_wxId").hide();
                    child.find("#btn_show_wxId").click(function(){
                        child.find("#btn_show_wxId").hide();
                        child.find("#value_wxId").show();
                        parseTrack("show-wechat-id", {
                            ip: geoinfo.ip,
                            city: geoinfo.city,
                            country: geoinfo.country
                        });
                    });
                    child.find("#btn_show_dhyx").click(function(){
                        child.find("#btn_show_dhyx").hide();
                        child.find("#value_dhyx").show();
                        parseTrack("show-dhyx", {
                            ip: geoinfo.ip,
                            city: geoinfo.city,
                            country: geoinfo.country
                        });
                    });
                    child.find("#btn_show_detail").click(function(){
                        child.find("#btn_show_detail").hide();
                        child.find(".detail").show();
                        parseTrack("show-detail", {
                            ip: geoinfo.ip,
                            city: geoinfo.city,
                            country: geoinfo.country
                        });
                    });
                    var rowLink = $.url().attr("path") + "?" + $.param($.extend($.url().param(), {"row": row}));
                    child.find("#row_link").attr("href", rowLink);
                    return child;
                };
                if (!parseInt($.url().param("row"))) {
                    var dataLength = data.feed.entry.length;
                    for (var i = dataLength - 1; i >= 0; i--) {
                        var child = createChild(i);
                        parent.append(child);
                    }
                } else {
                    var child = createChild(pageRow);
                    parent.append(child);
                }
            });

        });
    });
</script>

<!-- Google Tag Manager -->
<noscript>
    <iframe src="//www.googletagmanager.com/ns.html?id=GTM-PVD5TJ"
            height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<script>(function (w, d, s, l, i) {
    w[l] = w[l] || [];
    w[l].push({'gtm.start': new Date().getTime(), event: 'gtm.js'});
    var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : '';
    j.async = true;
    j.src =
            '//www.googletagmanager.com/gtm.js?id=' + i + dl;
    f.parentNode.insertBefore(j, f);
})(window, document, 'script', 'dataLayer', 'GTM-PVD5TJ');</script>
<!-- End Google Tag Manager -->

</body>
</html>